import psycopg2
from configparser import ConfigParser
import config
import csv
import Lease_Scraper as lease
import scraper as sale

def config(filename='C:/Users/Benjamin/Documents/UWTacoma/MSBA/database.ini', section='postgresql'):
    parser = ConfigParser()# create a parser
    parser.read(filename)# read config file
    # get section, default to postgresql
    db = {}
    if parser.has_section(section):
        params = parser.items(section)
        for param in params:
            db[param[0]] = param[1]
    else:
        raise Exception('Section {0} not found in the {1} file'.format(section, filename))

    return db

def connect(): #Found def config and def connect from https://www.postgresqltutorial.com/postgresql-python/connect/
    """ Connect to the PostgreSQL database server """
    conn = None
    try:
        params = config()# read connection parameters
        print('Connecting to the PostgreSQL database...')# connect to the PostgreSQL server
        conn = psycopg2.connect(**params)
        ##
        ETL_Building_Count = 'SELECT COUNT(*) FROM "ETL_Building"'
        cur = conn.cursor()
        cur.execute(ETL_Building_Count)# execute a statement
        count_test = cur.fetchone() #Fetch the results of the statement (Notice fetchone ONLY grabs the first record of the result)
        print("We are starting with {} records in the ETL Table.".format(count_test[0]))
        ETL_Buildng_wipe = 'TRUNCATE "ETL_Building"'
        if count_test[0] != 0:
            cur.execute(ETL_Buildng_wipe)
            print("{} records deleted from the ETL table.".format(count_test[0]))
            conn.commit()
        cur.close()

            # Here is the order of columns as they exist in the Buildings Table.  They have the numerical index for ease of reference.
        # Address_Line[0], City[1], State[2], Postal_Code[3], Property_Type[4], bg_geo_id[5],
        # CS_ID[6], url[7], Price[8], SquareFeet[9], Building_class[10], YearBuilt[11],
        # Sale_Type[12], Picture_URL[13], Upload_Date[14], Currently_Listed[15], Sale_Lease[16], old_CS_ID[17], Price_monthly[18],
        # Price_yearly[19], Expansion_SqrFt[20], Space[21], Condition[22], Available[23], Term[24]

            # Here is the order of columns as they show up in the loopnet_Sale_csv.
        # CS_ID[0] ,url[1] ,Address_Line[2] ,City[3] ,State[4],Postal_Code[5],
        # bg_geo_id[6], Property_Type[7], Price[8], SquareFeet[9], Building_Class[10],Year_Built[11],
        # Sale_Type[12], Picture_url[13], Upload_Date[14], Currently_Listed[15], Sale_Leased[16]

        cur = conn.cursor()
        # Upload Buildings for Sale to ETL_Buildings. loopnet_listings_2021_04_07-09_20_15_AM
        with open('loopnet_listings_2021_04_07-09_20_15_AM.csv', 'r') as f:
            reader = csv.reader(f)
            next(reader)  # Skip the header row.
            for i in reader:
                data = (i[2], i[3], i[4], i[5], i[7], i[6],
                        i[0], i[1], i[8], i[9], i[10], i[11],
                        i[12], i[13], i[14], i[15], i[16], None, None,
                        None, None, None, None, None, None)
                ETL_Building_insert ='INSERT INTO "ETL_Building" VALUES ' \
                               '(%s, %s, %s, %s, %s, %s,' \
                               ' %s, %s, cast(nullif(%s,\'\') as double precision), cast(nullif(%s,\'\') as double precision), %s, %s,' \
                               ' %s, %s, %s, %s, %s, %s, cast(nullif(%s,\'\') as double precision),' \
                               ' cast(nullif(%s,\'\') as double precision), cast(nullif(%s,\'\') as double precision), %s, %s, %s, %s)'
                print(data)
                cur.execute(ETL_Building_insert, data)
        conn.commit()
        cur.close()

        # Upload Buildings for Lease to ETL_Buildings.

            # Here is the order of columns as they exist in the Buildings Table.  They have the numerical index for ease of reference.
        # Address_Line[0], City[1], State[2], Postal_Code[3], Property_Type[4], bg_geo_id[5],
        # CS_ID[6], url[7], Price[8], SquareFeet[9], Building_class[10], YearBuilt[11],
        # Sale_Type[12], Picture_URL[13], Upload_Date[14], Currently_Listed[15], Sale_Lease[16], old_CS_ID[17], Price_monthly[18],
        # Price_yearly[19], Expansion_SqrFt[20], Space[21], Condition[22], Available[23], Term[24]

            # Here is the order of columns as they are listed in the loopnet_Lease_csv.
        # Address_Line[0], City[1], State[2], Postal_Code[3], Property_Type[4],bg_geo_id[5],
        # CS_ID[6], url[7], Price_month[8], Price_year[9], SquareFeet[10], Expansion_SqrFt[11],
        # Space[12], Condition[13],  Available[14], Term[15], Upload_Date[16], Currently_Listed[17], Sale_Lease[18]
        cur = conn.cursor()
        with open('loopnet_listings_lease_2021_04_07-01_52_PM.csv', 'r') as f:
            reader = csv.reader(f)
            next(reader)
            for i in reader: #In same order as reference above.
                data = (i[0], i[1], i[2], i[3], i[4], i[5],
                        i[6], i[7], None, i[10], None, None,
                        None, None, i[16], i[17], i[18], None, i[8],
                        i[9], i[11], i[12], i[13], i[14], i[15])
                lease_insert = 'INSERT INTO "ETL_Building" VALUES ' \
                               '(%s, %s, %s, %s, %s, %s,' \
                               ' %s, %s, cast(%s as double precision), cast(%s as double precision), %s, %s,' \
                               ' %s, %s, %s, %s, %s, %s, cast(nullif(%s,\'\') as double precision),' \
                               ' cast(nullif(%s,\'\') as double precision), cast(nullif(%s,\'\') as double precision), %s, %s, %s, %s)'
                print(data)
                cur.execute(lease_insert, data)
            conn.commit()

        # Statement to check ETL_Building against Building.
        cur = conn.cursor()
        left_exclude_join = 'SELECT "ETL_Building".* FROM "ETL_Building" Left JOIN "Building" ON "ETL_Building"."CS_ID" = "Building"."CS_ID" WHERE "Building"."CS_ID" IS NULL'
        cur.execute(left_exclude_join)
        left_exclude_join = cur.fetchall()
        print("There are {} records to be updated from ETL_Building.".format(len(left_exclude_join)))
        for i in left_exclude_join:
            data = (i[0], i[1], i[2], i[3], i[4], i[5], i[6], i[7], i[8], i[9], i[10], i[11], i[12], i[13], i[14], i[15], i[16],i[17],i[18],i[19],i[20],i[21],i[22],i[23],i[24])
            print("Inserting {} into the Building table".format(i[6]))
            insert_command = 'INSERT INTO "Building" VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)' # insert statement to Builing Table
            cur.execute(insert_command, data) #Pass in two arguments to make life easier.
            # Update Currently listed column to TRUE
            update_command = 'UPDATE "Building" SET "Currently_listed" = true WHERE "CS_ID" = \'{}\''.format(i[6])
            cur.execute(update_command)
        conn.commit()  #ensure that changes are updated to the database
        cur.close()

        cur = conn.cursor()
        print('PostgreSQL database version:')# execute a statement
        cur.execute('SELECT version()')
        db_version = cur.fetchone()# display the PostgreSQL database server version
        print(db_version)
        cur.close()# close the communication with the PostgreSQL
    except (Exception, psycopg2.DatabaseError) as error:
        print(error)
    finally:
        if conn is not None:
            conn.close()
            print('Database connection closed.')

def lease_insert():  # Found def config and def connect from https://www.postgresqltutorial.com/postgresql-python/connect/
    """ Connect to the PostgreSQL database server """
    conn = None
    url_list = lease.grab_placards()
    property_info = lease.building_dict(url_list)
    lease_listings = lease.lease_export(property_info)
    try:
        params = config()  # read connection parameters
        print('Connecting to the PostgreSQL database...')  # connect to the PostgreSQL server
        conn = psycopg2.connect(**params)
        cur = conn.cursor()
        etl_csid = 'SELECT "CS_ID" FROM "ETL_Building";'
        cur.execute(etl_csid)  # execute a statement
        etl_csid_list = cur.fetchall()  # Fetch the results of the statement (Notice fetchone ONLY grabs the first record of the result)
        csid_list = [t[0] for t in etl_csid_list]
        print("We are starting with {} records in the ETL Table.".format(len(etl_csid_list)))
        #lease_listings = [('2128 Pacific Ave', 'Tacoma', 'WA', '98402', 'Office/Retail', '530530616021', 'LN-21271211-1', 'https://www.loopnet.com/Listing/2128-Pacific-Ave-Tacoma-WA/21271211/', None, 3000, None, None, None, None, '2021-04-23', False, 'Lease', None, 28000, 336000, 12000, '1st Floor', 'Raw Space', '120 Days', 'Negotiable'), ('2128 Pacific Ave', 'Tacoma', 'WA', '98402', 'Office/Retail', '530530616021', 'LN-21271211-2', 'https://www.loopnet.com/Listing/2128-Pacific-Ave-Tacoma-WA/21271211/', None, 3000, None, None, None, None, '2021-04-23', False, 'Lease', None, 28000, 336000, 12000, '2nd Floor', 'Raw Space', '120 Days', 'Negotiable'), ('1551 Broadway', 'Tacoma', 'WA', '98402', 'Office', None, 'LN-6879898-1', 'https://www.loopnet.com/Listing/1551-Broadway-Tacoma-WA/6879898/', None, 6800, None, None, None, None, '2021-04-23', False, 'Lease', None, 11333, 136000, None, '3rd Fl, Ste 300', 'Full Build-Out', 'Now', '3-5 Yrs'), ('944-956 Broadway', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-22393034-1', 'https://www.loopnet.com/Listing/944-956-Broadway-Tacoma-WA/22393034/', None, 3721, None, None, None, None, '2021-04-23', False, 'Lease', None, 16400, 196800, 8200, '1st Fl, Ste 104', 'Full Build-Out', '30 Days', 'Negotiable'), ('944-956 Broadway', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-22393034-2', 'https://www.loopnet.com/Listing/944-956-Broadway-Tacoma-WA/22393034/', None, 9631, None, None, None, None, '2021-04-23', False, 'Lease', None, 16052, 192620, None, '1st Fl, Ste M100', 'Full Build-Out', '30 Days', 'Negotiable'), ('944-956 Broadway', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-22393034-3', 'https://www.loopnet.com/Listing/944-956-Broadway-Tacoma-WA/22393034/', None, 19157, None, None, None, None, '2021-04-23', False, 'Lease', None, 38314, 459768, None, '3rd Fl, Ste 300', 'Full Build-Out', '30 Days', 'Negotiable'), ('944-956 Broadway', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-22393034-4', 'https://www.loopnet.com/Listing/944-956-Broadway-Tacoma-WA/22393034/', None, 19071, None, None, None, None, '2021-04-23', False, 'Lease', None, 38142, 457704, None, '4th Fl, Ste 400', 'Full Build-Out', 'Now', 'Negotiable'), ('944-956 Broadway', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-22393034-5', 'https://www.loopnet.com/Listing/944-956-Broadway-Tacoma-WA/22393034/', None, 1310, None, None, None, None, '2021-04-23', False, 'Lease', None, 2620, 31440, None, '4th Fl, Ste 416', 'Full Build-Out', '30 Days', 'Negotiable'), ('944-956 Broadway', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-22393034-6', 'https://www.loopnet.com/Listing/944-956-Broadway-Tacoma-WA/22393034/', None, 1182, None, None, None, None, '2021-04-23', False, 'Lease', None, 2364, 28368, None, '4th Fl, Ste 468', 'Full Build-Out', '30 Days', 'Negotiable'), ('944-956 Broadway', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-22393034-7', 'https://www.loopnet.com/Listing/944-956-Broadway-Tacoma-WA/22393034/', None, 1861, None, None, None, None, '2021-04-23', False, 'Lease', None, 15082, 180980, 9049, '6th Fl, Ste 600', 'Full Build-Out', '30 Days', 'Negotiable'), ('944-956 Broadway', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-22393034-8', 'https://www.loopnet.com/Listing/944-956-Broadway-Tacoma-WA/22393034/', None, 9049, None, None, None, None, '2021-04-23', False, 'Lease', None, 15082, 180980, None, '7th Fl, Ste 700', 'Full Build-Out', '30 Days', 'Negotiable'), ('5436 S Tacoma Way', 'Tacoma', 'WA', '98409', 'Flex', '530530626001', 'LN-22751312-1', 'https://www.loopnet.com/Listing/5436-S-Tacoma-Way-Tacoma-WA/22751312/', None, 1500, None, None, None, None, '2021-04-23', False, 'Lease', None, 1500, 18000, None, '2nd Floor', 'Not Listed', 'Now', 'Negotiable'), ('955 Tacoma Ave S', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-22712808-1', 'https://www.loopnet.com/Listing/955-Tacoma-Ave-S-Tacoma-WA/22712808/', None, 907, None, None, None, None, '2021-04-23', False, 'Lease', None, 34801, 417609, 15467, '1st Fl, Ste 101', 'Full Build-Out', 'Jul 2021', 'Negotiable'), ('10903 26th Ave S', 'Lakewood', 'WA', '98499', 'Industrial', '530530717061', 'LN-22660660-1', 'https://www.loopnet.com/Listing/10903-26th-Ave-S-Lakewood-WA/22660660/', None, 2100, None, None, None, None, '2021-04-23', False, 'Lease', None, 1785, 21420, None, '1st Floor', 'Not Listed', '30 Days', 'Negotiable'), ('4701 S 19th St', 'Tacoma', 'WA', '98405', 'Office', '530530611004', 'LN-22589391-1', 'https://www.loopnet.com/Listing/4701-S-19th-St-Tacoma-WA/22589391/', None, 2430, None, None, None, None, '2021-04-23', False, 'Lease', None, 3645, 43740, None, '1st Fl, Ste 100', 'Not Listed', '30 Days', 'Negotiable'), ('3920 W Tapps Dr E', 'Lake Tapps', 'WA', '98391', 'Office/Medical', '530530703131', 'LN-22575498-1', 'https://www.loopnet.com/Listing/3920-W-Tapps-Dr-E-Lake-Tapps-WA/22575498/', None, 952, None, None, None, None, '2021-04-23', False, 'Lease', None, 1950, 23400, None, '1st Fl, Ste B', 'Full Build-Out', 'Now', '3-5 Yrs'), ('13704 24th St E', 'Sumner', 'WA', '98390', 'Industrial', '530530733013', 'LN-22464617-1', 'https://www.loopnet.com/Listing/13704-24th-St-E-Sumner-WA/22464617/', None, 3608, None, None, None, None, '2021-04-23', False, 'Lease', None, 4113, 49357, None, '1st Fl, Ste A107', 'Full Build-Out', '30 Days', 'Oct 2023'), ('2102 N Pearl St', 'Tacoma', 'WA', '98406', 'Office', '530530609081', 'LN-22452353-1', 'https://www.loopnet.com/Listing/2102-N-Pearl-St-Tacoma-WA/22452353/', None, 2180, None, None, None, None, '2021-04-23', False, 'Lease', None, 4178, 50140, None, '2nd Fl, Ste 202', 'Not Listed', '30 Days', 'Negotiable'), ('1250 Pacific Ave', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-22285057-1', 'https://www.loopnet.com/Listing/1250-Pacific-Ave-Tacoma-WA/22285057/', None, 3564, None, None, None, None, '2021-04-23', False, 'Lease', None, 9504, 114048, None, '1st Fl, Ste 110', 'Not Listed', 'Jul 2021', 'Negotiable'), ('11110 25th Ave E', 'Tacoma', 'WA', '98445', 'Industrial', '530530713053', 'LN-22201592-1', 'https://www.loopnet.com/Listing/11110-25th-Ave-E-Tacoma-WA/22201592/', None, 3078, None, None, None, None, '2021-04-23', False, 'Lease', None, 2770, 33242, None, '1st Fl, Ste D', 'Not Listed', '30 Days', 'Negotiable'), ('201 W Main St', 'Puyallup', 'WA', '98371', 'Office', '530530734073', 'LN-22192376-1', 'https://www.loopnet.com/Listing/201-W-Main-St-Puyallup-WA/22192376/', None, 27361, None, None, None, None, '2021-04-23', False, 'Lease', None, 41042, 492498, None, '1st Fl, Ste 201', 'Full Build-Out', 'Now', '5 Yrs'), ('10107 S Tacoma Way', 'Tacoma', 'WA', '98499', 'Industrial', '530530718073', 'LN-22165149-1', 'https://www.loopnet.com/Listing/10107-S-Tacoma-Way-Tacoma-WA/22165149/', None, 815, None, None, None, None, '2021-04-23', False, 'Lease', None, 994, 11932, None, '1st Fl, Ste D6', 'Not Listed', '30 Days', 'Negotiable'), ('11102 Sunrise Blvd E', 'Puyallup', 'WA', '98374', 'Office/Medical', '530530731232', 'LN-21967838-1', 'https://www.loopnet.com/Listing/11102-Sunrise-Blvd-E-Puyallup-WA/21967838/', None, 1044, None, None, None, None, '2021-04-23', False, 'Lease', None, 2784, 33408, None, '1st Fl, Ste 103', 'Not Listed', 'Now', 'Negotiable'), ('11102 Sunrise Blvd E', 'Puyallup', 'WA', '98374', 'Office/Medical', '530530731232', 'LN-21967838-2', 'https://www.loopnet.com/Listing/11102-Sunrise-Blvd-E-Puyallup-WA/21967838/', None, 1033, None, None, None, None, '2021-04-23', False, 'Lease', None, 2755, 33056, None, '1st Fl, Ste 105', 'Full Build-Out', 'Now', 'Negotiable'), ('11102 Sunrise Blvd E', 'Puyallup', 'WA', '98374', 'Office/Medical', '530530731232', 'LN-21967838-3', 'https://www.loopnet.com/Listing/11102-Sunrise-Blvd-E-Puyallup-WA/21967838/', None, 2221, None, None, None, None, '2021-04-23', False, 'Lease', None, 5923, 71072, None, '1st Fl, Ste 107', 'Not Listed', 'Now', 'Negotiable'), ('11102 Sunrise Blvd E', 'Puyallup', 'WA', '98374', 'Office/Medical', '530530731232', 'LN-21967838-4', 'https://www.loopnet.com/Listing/11102-Sunrise-Blvd-E-Puyallup-WA/21967838/', None, 3580, None, None, None, None, '2021-04-23', False, 'Lease', None, 9547, 114560, None, '1st Fl, Ste 201', 'Full Build-Out', 'Now', 'Negotiable'), ('13704 24th St E', 'Sumner', 'WA', '98390', 'Industrial', '530530733013', 'LN-21966193-1', 'https://www.loopnet.com/Listing/13704-24th-St-E-Sumner-WA/21966193/', None, 18032, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, None, '1st Floor', 'Not Listed', 'Now', 'Negotiable'), ('13704 24th St E', 'Sumner', 'WA', '98390', 'Industrial', '530530733013', 'LN-21966193-2', 'https://www.loopnet.com/Listing/13704-24th-St-E-Sumner-WA/21966193/', None, 3056, None, None, None, None, '2021-04-23', False, 'Lease', None, 3514, 42173, None, '1st Fl, Ste 104/105', 'Partial Build-Out', 'Now', 'Negotiable'), ('13704 24th St E', 'Sumner', 'WA', '98390', 'Industrial', '530530733013', 'LN-21966193-3', 'https://www.loopnet.com/Listing/13704-24th-St-E-Sumner-WA/21966193/', None, 5409, None, None, None, None, '2021-04-23', False, 'Lease', None, 6220, 74644, None, '1st Fl, Ste 104/107', 'Not Listed', 'Now', 'Negotiable'), ('13704 24th St E', 'Sumner', 'WA', '98390', 'Industrial', '530530733013', 'LN-21966193-4', 'https://www.loopnet.com/Listing/13704-24th-St-E-Sumner-WA/21966193/', None, 3608, None, None, None, None, '2021-04-23', False, 'Lease', None, 4330, 51955, None, '1st Fl, Ste 107/110', 'Not Listed', 'Now', 'Negotiable'), ('621 Pacific Ave', 'Tacoma', 'WA', '98402', 'Office', '530530616012', 'LN-21941980-1', 'https://www.loopnet.com/Listing/621-Pacific-Ave-Tacoma-WA/21941980/', None, 800, None, None, None, None, '2021-04-23', False, 'Lease', None, 1467, 17600, None, '2nd Floor', 'Not Listed', '30 Days', 'Negotiable'), ('5442 S Tacoma Way', 'Tacoma', 'WA', '98409', 'Office', '530530626001', 'LN-21931786-1', 'https://www.loopnet.com/Listing/5442-S-Tacoma-Way-Tacoma-WA/21931786/', None, 600, None, None, None, None, '2021-04-23', False, 'Lease', None, 804, 9648, None, '1st Fl, Ste Second Fl', 'Partial Build-Out', 'Now', 'Negotiable'), ('3560-3562 Bridgeport Way', 'University Place', 'WA', '98466', 'Office', '530530723103', 'LN-21796670-1', 'https://www.loopnet.com/Listing/3560-3562-Bridgeport-Way-University-Place-WA/21796670/', None, 2068, None, None, None, None, '2021-04-23', False, 'Lease', None, 2844, 34122, None, '1st Fl, Ste 1B', 'Partial Build-Out', 'Now', '5-10 Yrs'), ('3560-3562 Bridgeport Way', 'University Place', 'WA', '98466', 'Office', '530530723103', 'LN-21796670-2', 'https://www.loopnet.com/Listing/3560-3562-Bridgeport-Way-University-Place-WA/21796670/', None, 100, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, None, '1st Fl, Ste 1D', 'Full Build-Out', 'Now', '3-5 Yrs'), ('3560-3562 Bridgeport Way', 'University Place', 'WA', '98466', 'Office', '530530723103', 'LN-21796670-3', 'https://www.loopnet.com/Listing/3560-3562-Bridgeport-Way-University-Place-WA/21796670/', None, 2112, None, None, None, None, '2021-04-23', False, 'Lease', None, 3784, 45408, None, '2nd Fl, Ste 2D', 'Full Build-Out', 'Jul 2021', '5 Yrs'), ('3560-3562 Bridgeport Way', 'University Place', 'WA', '98466', 'Office', '530530723103', 'LN-21796670-4', 'https://www.loopnet.com/Listing/3560-3562-Bridgeport-Way-University-Place-WA/21796670/', None, 3198, None, None, None, None, '2021-04-23', False, 'Lease', None, 5730, 68757, None, '3rd Fl, Ste 3B', 'Full Build-Out', 'Now', '5-10 Yrs'), ('3560-3562 Bridgeport Way', 'University Place', 'WA', '98466', 'Office', '530530723103', 'LN-21796670-5', 'https://www.loopnet.com/Listing/3560-3562-Bridgeport-Way-University-Place-WA/21796670/', None, 1975, None, None, None, None, '2021-04-23', False, 'Lease', None, 2880, 34563, None, '3rd Fl, Ste 3D', 'Partial Build-Out', 'Now', '5 Yrs'), ('8016 Durango St SW', 'Lakewood', 'WA', '98499', 'Industrial', None, 'LN-21716234-1', 'https://www.loopnet.com/Listing/8016-Durango-St-SW-Lakewood-WA/21716234/', None, 3400, None, None, None, None, '2021-04-23', False, 'Lease', None, 3683, 44200, None, '1st Fl, Ste 01', 'Partial Build-Out', 'Jun 2021', 'Negotiable'), ('8016 Durango St SW', 'Lakewood', 'WA', '98499', 'Industrial', None, 'LN-21716234-2', 'https://www.loopnet.com/Listing/8016-Durango-St-SW-Lakewood-WA/21716234/', None, 1905, None, None, None, None, '2021-04-23', False, 'Lease', None, 2223, 26670, None, '1st Fl, Ste 7A', 'Not Listed', 'Jun 2021', 'Negotiable'), ('8016 Durango St SW', 'Lakewood', 'WA', '98499', 'Office', None, 'LN-21716234-3', 'https://www.loopnet.com/Listing/8016-Durango-St-SW-Lakewood-WA/21716234/', None, 1600, None, None, None, None, '2021-04-23', False, 'Lease', None, 1867, 22400, None, '2nd Fl, Ste 7B', 'Partial Build-Out', 'Feb 2022', 'Negotiable'), ('6302 112th St E', 'Puyallup', 'WA', '98373', 'Office', '530530713073', 'LN-21599371-1', 'https://www.loopnet.com/Listing/6302-112th-St-E-Puyallup-WA/21599371/', None, 2448, None, None, None, None, '2021-04-23', False, 'Lease', None, 4080, 48960, None, '1st Fl, Ste 200', 'Partial Build-Out', 'Now', '3-5 Yrs'), ('6302 112th St E', 'Puyallup', 'WA', '98373', 'Office', '530530713073', 'LN-21599371-2', 'https://www.loopnet.com/Listing/6302-112th-St-E-Puyallup-WA/21599371/', None, 2484, None, None, None, None, '2021-04-23', False, 'Lease', None, 4347, 52164, None, '1st Fl, Ste 300', 'Shell Space', 'Now', '3-5 Yrs'), ('13701 24th St E', 'Sumner', 'WA', '98390', 'Industrial', '530530733013', 'LN-21456814-1', 'https://www.loopnet.com/Listing/13701-24th-St-E-Sumner-WA/21456814/', None, 6010, None, None, None, None, '2021-04-23', False, 'Lease', None, 6912, 82938, None, '1st Fl, Ste 3/4/7', 'Not Listed', '30 Days', 'Negotiable'), ('13701 24th St E', 'Sumner', 'WA', '98390', 'Industrial', '530530733013', 'LN-21456814-2', 'https://www.loopnet.com/Listing/13701-24th-St-E-Sumner-WA/21456814/', None, 2627, None, None, None, None, '2021-04-23', False, 'Lease', None, 3021, 36253, None, '1st Fl, Ste 4', 'Not Listed', 'Jun 2021', 'Negotiable'), ('8412 Myers Rd E', 'Bonney Lake', 'WA', '98391', 'Office/Medical', '530530703083', 'LN-21394245-1', 'https://www.loopnet.com/Listing/8412-Myers-Rd-E-Bonney-Lake-WA/21394245/', None, 2504, None, None, None, None, '2021-04-23', False, 'Lease', None, 4173, 50080, None, '1st Fl, Ste 101', 'Full Build-Out', 'Now', '3-5 Yrs'), ('8412 Myers Rd E', 'Bonney Lake', 'WA', '98391', 'Office', '530530703083', 'LN-21394245-2', 'https://www.loopnet.com/Listing/8412-Myers-Rd-E-Bonney-Lake-WA/21394245/', None, 956, None, None, None, None, '2021-04-23', False, 'Lease', None, 1275, 15296, None, '2nd Fl, Ste 201', 'Full Build-Out', 'Now', '3 Yrs'), ('3906 S 74th St', 'Tacoma', 'WA', '98409', 'Office', '530530628022', 'LN-21365027-1', 'https://www.loopnet.com/Listing/3906-S-74th-St-Tacoma-WA/21365027/', None, 1276, None, None, None, None, '2021-04-23', False, 'Lease', None, 1967, 23606, None, '2nd Fl, Ste 203A', 'Not Listed', '30 Days', 'Negotiable'), ('7817 Pacific Ave', 'Tacoma', 'WA', '98408', 'Office', '530530634012', 'LN-21343922-1', 'https://www.loopnet.com/Listing/7817-Pacific-Ave-Tacoma-WA/21343922/', None, 912, None, None, None, None, '2021-04-23', False, 'Lease', None, 2432, 29184, 1824, '1st Floor', 'Not Listed', 'Now', 'Negotiable'), ('7817 Pacific Ave', 'Tacoma', 'WA', '98408', 'Office', '530530634012', 'LN-21343922-2', 'https://www.loopnet.com/Listing/7817-Pacific-Ave-Tacoma-WA/21343922/', None, 750, None, None, None, None, '2021-04-23', False, 'Lease', None, 875, 10500, None, '2nd Floor', 'Not Listed', 'Now', 'Negotiable'), ('8114 112th Street Ct E', 'Puyallup', 'WA', '98373', 'Office', '530530713071', 'LN-21190153-1', 'https://www.loopnet.com/Listing/8114-112th-Street-Ct-E-Puyallup-WA/21190153/', None, 2110, None, None, None, None, '2021-04-23', False, 'Lease', None, 2989, 35870, None, '1st Fl, Ste 8114A', 'Partial Build-Out', 'Now', 'Negotiable'), ('8114 112th Street Ct E', 'Puyallup', 'WA', '98373', 'Office', '530530713071', 'LN-21190153-2', 'https://www.loopnet.com/Listing/8114-112th-Street-Ct-E-Puyallup-WA/21190153/', None, 1110, None, None, None, None, '2021-04-23', False, 'Lease', None, 2989, 35870, 2110, '1st Fl, Ste 8114A1', 'Partial Build-Out', 'Now', 'Negotiable'), ('8114 112th Street Ct E', 'Puyallup', 'WA', '98373', 'Office', '530530713071', 'LN-21190153-3', 'https://www.loopnet.com/Listing/8114-112th-Street-Ct-E-Puyallup-WA/21190153/', None, 910, None, None, None, None, '2021-04-23', False, 'Lease', None, 2989, 35870, 2110, '1st Fl, Ste 8114A2', 'Partial Build-Out', 'Now', 'Negotiable'), ('2200 109th St S', 'Tacoma', 'WA', '98444', 'Flex', '530530717061', 'LN-21028987-1', 'https://www.loopnet.com/Listing/2200-109th-St-S-Tacoma-WA/21028987/', None, 392, None, None, None, None, '2021-04-23', False, 'Lease', None, 814, 9769, None, '1st Fl, Ste 205', 'Raw Space', 'Now', '1 Yr'), ('2200 109th St S', 'Tacoma', 'WA', '98444', 'Flex', '530530717061', 'LN-21028987-2', 'https://www.loopnet.com/Listing/2200-109th-St-S-Tacoma-WA/21028987/', None, 308, None, None, None, None, '2021-04-23', False, 'Lease', None, 617, 7404, None, '1st Fl, Ste 416', 'Raw Space', 'Now', 'Negotiable'), ('3608 S 74th St', 'Tacoma', 'WA', '98409', 'Flex', '530530629023', 'LN-21017622-1', 'https://www.loopnet.com/Listing/3608-S-74th-St-Tacoma-WA/21017622/', None, 160, None, None, None, None, '2021-04-23', False, 'Lease', None, 2833, 34000, 2000, '1st Floor', 'Raw Space', 'Now', 'Negotiable'), ('7642 Pacific Ave', 'Tacoma', 'WA', '98408', 'Office', '530530634012', 'LN-20861738-1', 'https://www.loopnet.com/Listing/7642-Pacific-Ave-Tacoma-WA/20861738/', None, 761, None, None, None, None, '2021-04-23', False, 'Lease', None, 1142, 13698, None, '1st Fl, Ste A', 'Full Build-Out', 'Now', '3-5 Yrs'), ('7642 Pacific Ave', 'Tacoma', 'WA', '98408', 'Office', '530530634012', 'LN-20861738-2', 'https://www.loopnet.com/Listing/7642-Pacific-Ave-Tacoma-WA/20861738/', None, 1100, None, None, None, None, '2021-04-23', False, 'Lease', None, 1650, 19800, None, '1st Fl, Ste B', 'Full Build-Out', 'Now', '3-5 Yrs'), ('405 Valley Ave', 'Puyallup', 'WA', '98371', 'Industrial', None, 'LN-20833460-1', 'https://www.loopnet.com/Listing/405-Valley-Ave-Puyallup-WA/20833460/', None, 3395, None, None, None, None, '2021-04-23', False, 'Lease', None, 37477, 449718, 44090, '1st Floor', 'Not Listed', 'Now', 'Negotiable'), ('14801 Spring St SW', 'Lakewood', 'WA', '98439', 'Industrial', '530530720001', 'LN-20396561-1', 'https://www.loopnet.com/Listing/14801-Spring-St-SW-Lakewood-WA/20396561/', None, 200000, None, None, None, None, '2021-04-23', False, 'Lease', None, 200000, 2400000, None, '1st Floor', 'Full Build-Out', 'TBD', 'Negotiable'), ('2402-2412 S C St', 'Tacoma', 'WA', '98402', 'Office', '530530616021', 'LN-20204390-1', 'https://www.loopnet.com/Listing/2402-2412-S-C-St-Tacoma-WA/20204390/', None, 1357, None, None, None, None, '2021-04-23', False, 'Lease', None, 1357, 16284, None, '1st Floor', 'Not Listed', 'Now', 'Negotiable'), ('2416 S C St', 'Tacoma', 'WA', '98402', 'Office/Retail', '530530616021', 'LN-20204354-1', 'https://www.loopnet.com/Listing/2416-S-C-St-Tacoma-WA/20204354/', None, 11200, None, None, None, None, '2021-04-23', False, 'Lease', None, 8400, 100800, None, '1st Floor', 'Not Listed', 'Now', 'Negotiable'), ('2416 S C St', 'Tacoma', 'WA', '98402', 'Office/Retail', '530530616021', 'LN-20204354-2', 'https://www.loopnet.com/Listing/2416-S-C-St-Tacoma-WA/20204354/', None, 11200, None, None, None, None, '2021-04-23', False, 'Lease', None, 8400, 100800, None, '2nd Floor', 'Not Listed', 'Now', 'Negotiable'), ('13613 Meridian E', 'Puyallup', 'WA', '98373', 'Office', None, 'LN-20189179-1', 'https://www.loopnet.com/Listing/13613-Meridian-E-Puyallup-WA/20189179/', None, 1166, None, None, None, None, '2021-04-23', False, 'Lease', None, 1846, 22154, None, '2nd Fl, Ste V1', 'Full Build-Out', 'Now', 'Negotiable'), ('535 Dock St', 'Tacoma', 'WA', '98402', 'Office', '530530602001', 'LN-19789988-1', 'https://www.loopnet.com/Listing/535-Dock-St-Tacoma-WA/19789988/', None, 1477, None, None, None, None, '2021-04-23', False, 'Lease', None, 2708, 32494, None, '2nd Fl, Ste 204', 'Not Listed', 'Now', 'Negotiable'), ('2415 70th Ave W', 'University Place', 'WA', '98466', 'Industrial', '530530723111', 'LN-19320875-1', 'https://www.loopnet.com/Listing/2415-70th-Ave-W-University-Place-WA/19320875/', None, 952, None, None, None, None, '2021-04-23', False, 'Lease', None, 1629, 19545, None, '1st Fl, Ste 06-11', 'Raw Space', 'Now', '1 Yr'), ('14706 Meridian Ave E', 'Puyallup', 'WA', '98375', 'Flex', None, 'LN-19320327-1', 'https://www.loopnet.com/Listing/14706-Meridian-Ave-E-Puyallup-WA/19320327/', None, 300, None, None, None, None, '2021-04-23', False, 'Lease', None, 3000, 36000, 2000, '1st Floor', 'Raw Space', 'Now', 'Negotiable'), ('2115 S 56th St', 'Tacoma', 'WA', '98409', 'Office', '530530630001', 'LN-18906455-1', 'https://www.loopnet.com/Listing/2115-S-56th-St-Tacoma-WA/18906455/', None, 1408, None, None, None, None, '2021-04-23', False, 'Lease', None, 1995, 23936, None, '1st Fl, Ste 310', 'Not Listed', 'Now', 'Negotiable'), ('1011 E Main Ave', 'Puyallup', 'WA', '98372', 'Office/Medical', '530530734064', 'LN-18740599-1', 'https://www.loopnet.com/Listing/1011-E-Main-Ave-Puyallup-WA/18740599/', None, 2332, None, None, None, None, '2021-04-23', False, 'Lease', None, 3304, 39644, None, '1st Fl, Ste 102', 'Full Build-Out', 'Now', '3-5 Yrs'), ('1011 E Main Ave', 'Puyallup', 'WA', '98372', 'Office/Medical', '530530734064', 'LN-18740599-2', 'https://www.loopnet.com/Listing/1011-E-Main-Ave-Puyallup-WA/18740599/', None, 1132, None, None, None, None, '2021-04-23', False, 'Lease', None, 1604, 19244, None, '2nd Fl, Ste 210', 'Raw Space', '30 Days', '3-5 Yrs'), ('1011 E Main Ave', 'Puyallup', 'WA', '98372', 'Office', '530530734064', 'LN-18740599-3', 'https://www.loopnet.com/Listing/1011-E-Main-Ave-Puyallup-WA/18740599/', None, 1250, None, None, None, None, '2021-04-23', False, 'Lease', None, 1366, 16388, None, '2nd Fl, Ste 220', 'Full Build-Out', '30 Days', '3-5 Yrs'), ('1011 E Main Ave', 'Puyallup', 'WA', '98372', 'Office', '530530734064', 'LN-18740599-4', 'https://www.loopnet.com/Listing/1011-E-Main-Ave-Puyallup-WA/18740599/', None, 1127, None, None, None, None, '2021-04-23', False, 'Lease', None, 1597, 19159, None, '3rd Fl, Ste 330', 'Full Build-Out', 'Now', '3-5 Yrs'), ('1011 E Main Ave', 'Puyallup', 'WA', '98372', 'Office', '530530734064', 'LN-18740599-5', 'https://www.loopnet.com/Listing/1011-E-Main-Ave-Puyallup-WA/18740599/', None, 215, None, None, None, None, '2021-04-23', False, 'Lease', None, 650, 7800, None, '4th Fl, Ste 402', 'Full Build-Out', 'Now', 'Negotiable'), ('1011 E Main Ave', 'Puyallup', 'WA', '98372', 'Office', '530530734064', 'LN-18740599-6', 'https://www.loopnet.com/Listing/1011-E-Main-Ave-Puyallup-WA/18740599/', None, 154, None, None, None, None, '2021-04-23', False, 'Lease', None, 499, 6000, None, '4th Fl, Ste 403', 'Full Build-Out', 'Now', 'Negotiable'), ('1011 E Main Ave', 'Puyallup', 'WA', '98372', 'Office', '530530734064', 'LN-18740599-7', 'https://www.loopnet.com/Listing/1011-E-Main-Ave-Puyallup-WA/18740599/', None, 137, None, None, None, None, '2021-04-23', False, 'Lease', None, 444, 5338, None, '4th Fl, Ste 404', 'Full Build-Out', 'Now', 'Negotiable'), ('1011 E Main Ave', 'Puyallup', 'WA', '98372', 'Office', '530530734064', 'LN-18740599-8', 'https://www.loopnet.com/Listing/1011-E-Main-Ave-Puyallup-WA/18740599/', None, 2176, None, None, None, None, '2021-04-23', False, 'Lease', None, 3083, 36992, None, '4th Fl, Ste 420', 'Full Build-Out', 'Now', '3-5 Yrs'), ('950 Pacific Ave', 'Tacoma', 'WA', '98402', 'Retail', '530530616011', 'LN-18421025-1', 'https://www.loopnet.com/Listing/950-Pacific-Ave-Tacoma-WA/18421025/', None, 3500, None, None, None, None, '2021-04-23', False, 'Lease', None, 7583, 91000, None, '1st Fl, Ste 102', 'Not Listed', 'Now', 'Negotiable'), ('950 Pacific Ave', 'Tacoma', 'WA', '98402', 'Retail', '530530616011', 'LN-18421025-2', 'https://www.loopnet.com/Listing/950-Pacific-Ave-Tacoma-WA/18421025/', None, 2390, None, None, None, None, '2021-04-23', False, 'Lease', None, 5178, 62140, None, '1st Fl, Ste 105', 'Not Listed', 'Now', 'Negotiable'), ('950 Pacific Ave', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-18421025-3', 'https://www.loopnet.com/Listing/950-Pacific-Ave-Tacoma-WA/18421025/', None, 1630, None, None, None, None, '2021-04-23', False, 'Lease', None, 3532, 42380, None, '2nd Fl, Ste 205', 'Not Listed', 'Now', 'Negotiable'), ('950 Pacific Ave', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-18421025-4', 'https://www.loopnet.com/Listing/950-Pacific-Ave-Tacoma-WA/18421025/', None, 559, None, None, None, None, '2021-04-23', False, 'Lease', None, 1211, 14534, None, '4th Fl, Ste 452', 'Not Listed', 'Now', 'Negotiable'), ('950 Pacific Ave', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-18421025-5', 'https://www.loopnet.com/Listing/950-Pacific-Ave-Tacoma-WA/18421025/', None, 740, None, None, None, None, '2021-04-23', False, 'Lease', None, 1603, 19240, None, '6th Fl, Ste 625', 'Not Listed', 'Now', 'Negotiable'), ('950 Pacific Ave', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-18421025-6', 'https://www.loopnet.com/Listing/950-Pacific-Ave-Tacoma-WA/18421025/', None, 437, None, None, None, None, '2021-04-23', False, 'Lease', None, 946, 11362, None, '6th Fl, Ste 640', 'Not Listed', 'Now', 'Negotiable'), ('950 Pacific Ave', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-18421025-7', 'https://www.loopnet.com/Listing/950-Pacific-Ave-Tacoma-WA/18421025/', None, 2533, None, None, None, None, '2021-04-23', False, 'Lease', None, 5488, 65858, None, '7th Fl, Ste 720', 'Partial Build-Out', 'Now', 'Negotiable'), ('950 Pacific Ave', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-18421025-8', 'https://www.loopnet.com/Listing/950-Pacific-Ave-Tacoma-WA/18421025/', None, 1444, None, None, None, None, '2021-04-23', False, 'Lease', None, 3129, 37544, None, '7th Fl, Ste 725', 'Partial Build-Out', 'Now', 'Negotiable'), ('950 Pacific Ave', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-18421025-9', 'https://www.loopnet.com/Listing/950-Pacific-Ave-Tacoma-WA/18421025/', None, 535, None, None, None, None, '2021-04-23', False, 'Lease', None, 1159, 13910, None, '10th Fl, Ste 1030', 'Partial Build-Out', 'Now', 'Negotiable'), ('2316 S State St', 'Tacoma', 'WA', '98405', 'Office', '530530617003', 'LN-18288601-1', 'https://www.loopnet.com/Listing/2316-S-State-St-Tacoma-WA/18288601/', None, 2640, None, None, None, None, '2021-04-23', False, 'Lease', None, 3520, 42240, None, '1st Floor', 'Not Listed', 'Now', 'Negotiable'), ('8811 S Tacoma Way', 'Tacoma', 'WA', '98499', 'Flex', '530530718083', 'LN-18263544-1', 'https://www.loopnet.com/Listing/8811-S-Tacoma-Way-Tacoma-WA/18263544/', None, 3379, None, None, None, None, '2021-04-23', False, 'Lease', None, 3661, 43927, None, '1st Fl, Ste 101', 'Partial Build-Out', 'Now', 'Negotiable'), ('8811 S Tacoma Way', 'Tacoma', 'WA', '98499', 'Office/Retail', '530530718083', 'LN-18263544-2', 'https://www.loopnet.com/Listing/8811-S-Tacoma-Way-Tacoma-WA/18263544/', None, 593, None, None, None, None, '2021-04-23', False, 'Lease', None, 741, 8895, None, '1st Fl, Ste 105', 'Not Listed', 'Now', 'Negotiable'), ('8811 S Tacoma Way', 'Tacoma', 'WA', '98499', 'Office/Retail', '530530718083', 'LN-18263544-3', 'https://www.loopnet.com/Listing/8811-S-Tacoma-Way-Tacoma-WA/18263544/', None, 2538, None, None, None, None, '2021-04-23', False, 'Lease', None, 3173, 38070, None, '1st Fl, Ste 106', 'Not Listed', 'Now', 'Negotiable'), ('8811 S Tacoma Way', 'Tacoma', 'WA', '98499', 'Office', '530530718083', 'LN-18263544-4', 'https://www.loopnet.com/Listing/8811-S-Tacoma-Way-Tacoma-WA/18263544/', None, 2051, None, None, None, None, '2021-04-23', False, 'Lease', None, 2222, 26663, None, '2nd Fl, Ste 201', 'Full Build-Out', 'Now', 'Negotiable'), ('8811 S Tacoma Way', 'Tacoma', 'WA', '98499', 'Office', '530530718083', 'LN-18263544-5', 'https://www.loopnet.com/Listing/8811-S-Tacoma-Way-Tacoma-WA/18263544/', None, 892, None, None, None, None, '2021-04-23', False, 'Lease', None, 1115, 13380, None, '2nd Fl, Ste 205', 'Full Build-Out', 'Now', 'Negotiable'), ('8811 S Tacoma Way', 'Tacoma', 'WA', '98499', 'Office', '530530718083', 'LN-18263544-6', 'https://www.loopnet.com/Listing/8811-S-Tacoma-Way-Tacoma-WA/18263544/', None, 909, None, None, None, None, '2021-04-23', False, 'Lease', None, 1061, 12726, None, '2nd Fl, Ste 208', 'Full Build-Out', 'Now', 'Negotiable'), ('8811 S Tacoma Way', 'Tacoma', 'WA', '98499', 'Office', '530530718083', 'LN-18263544-7', 'https://www.loopnet.com/Listing/8811-S-Tacoma-Way-Tacoma-WA/18263544/', None, 611, None, None, None, None, '2021-04-23', False, 'Lease', None, 712, 8554, None, '2nd Fl, Ste 209', 'Full Build-Out', 'Now', 'Negotiable'), ('8811 S Tacoma Way', 'Tacoma', 'WA', '98499', 'Office', '530530718083', 'LN-18263544-8', 'https://www.loopnet.com/Listing/8811-S-Tacoma-Way-Tacoma-WA/18263544/', None, 942, None, None, None, None, '2021-04-23', False, 'Lease', None, 1099, 13188, None, '2nd Fl, Ste 210', 'Full Build-Out', 'Now', 'Negotiable'), ('9810 40th Ave SW', 'Lakewood', 'WA', '98499', 'Flex', '530530718074', 'LN-18011571-1', 'https://www.loopnet.com/Listing/9810-40th-Ave-SW-Lakewood-WA/18011571/', None, 3567, None, None, None, None, '2021-04-23', False, 'Lease', None, 2069, 24826, None, '1st Fl, Ste A', 'Not Listed', 'Now', 'Negotiable'), ('9810 40th Ave SW', 'Lakewood', 'WA', '98499', 'Office', '530530718074', 'LN-18011571-2', 'https://www.loopnet.com/Listing/9810-40th-Ave-SW-Lakewood-WA/18011571/', None, 1896, None, None, None, None, '2021-04-23', False, 'Lease', None, 1896, 22752, None, '1st Fl, Ste D', 'Not Listed', 'Now', 'Negotiable'), ('2748 Milton Way', 'Milton', 'WA', '98354', 'Office', '530530707032', 'LN-17642689-1', 'https://www.loopnet.com/Listing/2748-Milton-Way-Milton-WA/17642689/', None, 1229, None, None, None, None, '2021-04-23', False, 'Lease', None, 2048, 24580, None, '2nd Fl, Ste 201', 'Full Build-Out', 'Now', '5 Yrs'), ('2748 Milton Way', 'Milton', 'WA', '98354', 'Office', '530530707032', 'LN-17642689-2', 'https://www.loopnet.com/Listing/2748-Milton-Way-Milton-WA/17642689/', None, 2317, None, None, None, None, '2021-04-23', False, 'Lease', None, 3862, 46340, None, '2nd Fl, Ste 203', 'Full Build-Out', 'Now', '5 Yrs'), ('2748 Milton Way', 'Milton', 'WA', '98354', 'Office', '530530707032', 'LN-17642689-3', 'https://www.loopnet.com/Listing/2748-Milton-Way-Milton-WA/17642689/', None, 2975, None, None, None, None, '2021-04-23', False, 'Lease', None, 4958, 59500, None, '2nd Fl, Ste 205', 'Full Build-Out', 'Now', '5 Yrs'), ('2748 Milton Way', 'Milton', 'WA', '98354', 'Office/Medical', '530530707032', 'LN-17642689-4', 'https://www.loopnet.com/Listing/2748-Milton-Way-Milton-WA/17642689/', None, 2473, None, None, None, None, '2021-04-23', False, 'Lease', None, 3297, 39568, None, '2nd Fl, Ste 210', 'Shell Space', 'Now', '5 Yrs'), ('2748 Milton Way', 'Milton', 'WA', '98354', 'Office/Medical', '530530707032', 'LN-17642689-5', 'https://www.loopnet.com/Listing/2748-Milton-Way-Milton-WA/17642689/', None, 1701, None, None, None, None, '2021-04-23', False, 'Lease', None, 2835, 34020, None, '2nd Fl, Ste 211', 'Full Build-Out', 'Now', '5 Yrs'), ('2748 Milton Way', 'Milton', 'WA', '98354', 'Office', '530530707032', 'LN-17642689-6', 'https://www.loopnet.com/Listing/2748-Milton-Way-Milton-WA/17642689/', None, 1707, None, None, None, None, '2021-04-23', False, 'Lease', None, 2845, 34140, None, '2nd Fl, Ste 240', 'Full Build-Out', 'Now', '5 Yrs'), ('9704 40th Ave SW', 'Lakewood', 'WA', '98499', 'Industrial', '530530718074', 'LN-17387934-1', 'https://www.loopnet.com/Listing/9704-40th-Ave-SW-Lakewood-WA/17387934/', None, 5000, None, None, None, None, '2021-04-23', False, 'Lease', None, 7000, 84000, 10000, '1st Fl, Ste C&D', 'Not Listed', 'Now', 'Negotiable'), ('16515 Meridian E', 'Puyallup', 'WA', '98375', 'Office/Medical', None, 'LN-16373925-1', 'https://www.loopnet.com/Listing/16515-Meridian-E-Puyallup-WA/16373925/', None, 2985, None, None, None, None, '2021-04-23', False, 'Lease', None, 5597, 67163, None, '2nd Fl, Ste 201B', 'Full Build-Out', 'Now', '3-5 Yrs'), ('2101 S Tacoma Way', 'Tacoma', 'WA', '98409', 'Office', None, 'LN-15670323-1', 'https://www.loopnet.com/Listing/2101-S-Tacoma-Way-Tacoma-WA/15670323/', None, 15600, None, None, None, None, '2021-04-23', False, 'Lease', None, 8580, 102960, None, '1st Fl, Ste 100', 'Not Listed', 'Now', 'Negotiable'), ('2101 S Tacoma Way', 'Tacoma', 'WA', '98409', 'Office', None, 'LN-15670323-2', 'https://www.loopnet.com/Listing/2101-S-Tacoma-Way-Tacoma-WA/15670323/', None, 15600, None, None, None, None, '2021-04-23', False, 'Lease', None, 8580, 102960, None, '2nd Fl, Ste 200', 'Not Listed', 'Now', 'Negotiable'), ('2605 Jahn Ave NW', 'Gig Harbor', 'WA', '98335', 'Office', '530530724083', 'LN-15540489-1', 'https://www.loopnet.com/Listing/2605-Jahn-Ave-NW-Gig-Harbor-WA/15540489/', None, 2537, None, None, None, None, '2021-04-23', False, 'Lease', None, 3488, 41861, None, '1st Fl, Ste B 10-12', 'Not Listed', 'Now', 'Negotiable'), ('2605 Jahn Ave NW', 'Gig Harbor', 'WA', '98335', 'Office', '530530724083', 'LN-15540489-2', 'https://www.loopnet.com/Listing/2605-Jahn-Ave-NW-Gig-Harbor-WA/15540489/', None, 776, None, None, None, None, '2021-04-23', False, 'Lease', None, 1293, 15520, None, '1st Fl, Ste C-8', 'Not Listed', 'Now', 'Negotiable'), ('2605 Jahn Ave NW', 'Gig Harbor', 'WA', '98335', 'Retail', '530530724083', 'LN-15540489-3', 'https://www.loopnet.com/Listing/2605-Jahn-Ave-NW-Gig-Harbor-WA/15540489/', None, 5123, None, None, None, None, '2021-04-23', False, 'Lease', None, 7044, 84530, None, '1st Fl, Ste G7-12', 'Not Listed', 'Now', 'Negotiable'), ('2605 Jahn Ave NW', 'Gig Harbor', 'WA', '98335', 'Office', '530530724083', 'LN-15540489-4', 'https://www.loopnet.com/Listing/2605-Jahn-Ave-NW-Gig-Harbor-WA/15540489/', None, 1395, None, None, None, None, '2021-04-23', False, 'Lease', None, 2151, 25808, None, '2nd Fl, Ste A-4', 'Not Listed', 'Aug 2021', 'Negotiable'), ('2605 Jahn Ave NW', 'Gig Harbor', 'WA', '98335', 'Office', '530530724083', 'LN-15540489-5', 'https://www.loopnet.com/Listing/2605-Jahn-Ave-NW-Gig-Harbor-WA/15540489/', None, 1061, None, None, None, None, '2021-04-23', False, 'Lease', None, 1636, 19629, None, '2nd Fl, Ste B-4', 'Not Listed', 'Now', 'Negotiable'), ('2605 Jahn Ave NW', 'Gig Harbor', 'WA', '98335', 'Office', '530530724083', 'LN-15540489-6', 'https://www.loopnet.com/Listing/2605-Jahn-Ave-NW-Gig-Harbor-WA/15540489/', None, 774, None, None, None, None, '2021-04-23', False, 'Lease', None, 1395, 16742, None, '2nd Fl, Ste E-3', 'Not Listed', 'Now', 'Negotiable'), ('2605 Jahn Ave NW', 'Gig Harbor', 'WA', '98335', 'Office/Retail', '530530724083', 'LN-15540489-7', 'https://www.loopnet.com/Listing/2605-Jahn-Ave-NW-Gig-Harbor-WA/15540489/', None, 1362, None, None, None, None, '2021-04-23', False, 'Lease', None, 2100, 25197, None, '2nd Fl, Ste F-05', 'Full Build-Out', 'Now', 'Negotiable'), ('2605 Jahn Ave NW', 'Gig Harbor', 'WA', '98335', 'Retail', '530530724083', 'LN-15540489-8', 'https://www.loopnet.com/Listing/2605-Jahn-Ave-NW-Gig-Harbor-WA/15540489/', None, 5268, None, None, None, None, '2021-04-23', False, 'Lease', None, 8122, 97458, None, '2nd Fl, Ste G1-6', 'Not Listed', 'Now', 'Negotiable'), ('909 A St', 'Tacoma', 'WA', '98402', 'Restaurant', '530530616012', 'LN-15029641-1', 'https://www.loopnet.com/Listing/909-A-St-Tacoma-WA/15029641/', None, 3349, None, None, None, None, '2021-04-23', False, 'Lease', None, 8652, 103819, None, '1st Floor', 'Partial Build-Out', 'Now', 'Negotiable'), ('909 A St', 'Tacoma', 'WA', '98402', 'Office', '530530616012', 'LN-15029641-2', 'https://www.loopnet.com/Listing/909-A-St-Tacoma-WA/15029641/', None, 4000, None, None, None, None, '2021-04-23', False, 'Lease', None, 50429, 605151, 19521, '3rd Floor', 'Not Listed', 'Now', 'Negotiable'), ('909 A St', 'Tacoma', 'WA', '98402', 'Office', '530530616012', 'LN-15029641-3', 'https://www.loopnet.com/Listing/909-A-St-Tacoma-WA/15029641/', None, 4000, None, None, None, None, '2021-04-23', False, 'Lease', None, 50008, 600098, 19358, '4th Floor', 'Not Listed', 'Now', 'Negotiable'), ('909 A St', 'Tacoma', 'WA', '98402', 'Office', '530530616012', 'LN-15029641-4', 'https://www.loopnet.com/Listing/909-A-St-Tacoma-WA/15029641/', None, 4000, None, None, None, None, '2021-04-23', False, 'Lease', None, 50008, 600098, 19358, '5th Floor', 'Not Listed', 'Now', 'Negotiable'), ('909 A St', 'Tacoma', 'WA', '98402', 'Office', '530530616012', 'LN-15029641-5', 'https://www.loopnet.com/Listing/909-A-St-Tacoma-WA/15029641/', None, 4000, None, None, None, None, '2021-04-23', False, 'Lease', None, 11312, 135749, 4379, '6th Floor', 'Not Listed', 'Now', 'Negotiable'), ('909 A St', 'Tacoma', 'WA', '98402', 'Office', '530530616012', 'LN-15029641-6', 'https://www.loopnet.com/Listing/909-A-St-Tacoma-WA/15029641/', None, 4000, None, None, None, None, '2021-04-23', False, 'Lease', None, 27244, 326926, 10546, '8th Floor', 'Not Listed', 'Now', 'Negotiable'), ('909 A St', 'Tacoma', 'WA', '98402', 'Office', '530530616012', 'LN-15029641-7', 'https://www.loopnet.com/Listing/909-A-St-Tacoma-WA/15029641/', None, 400, None, None, None, None, '2021-04-23', False, 'Lease', None, 50008, 600098, 19358, '9th Floor', 'Not Listed', 'Now', 'Negotiable'), ('909 A St', 'Tacoma', 'WA', '98402', 'Office', '530530616012', 'LN-15029641-8', 'https://www.loopnet.com/Listing/909-A-St-Tacoma-WA/15029641/', None, 4000, None, None, None, None, '2021-04-23', False, 'Lease', None, 50008, 600098, 19358, '10th Floor', 'Not Listed', 'Now', 'Negotiable'), ('909 A St', 'Tacoma', 'WA', '98402', 'Office', '530530616012', 'LN-15029641-9', 'https://www.loopnet.com/Listing/909-A-St-Tacoma-WA/15029641/', None, 4000, None, None, None, None, '2021-04-23', False, 'Lease', None, 20512, 246140, 7940, '11th Floor', 'Not Listed', 'Now', 'Negotiable'), ('5219 N Shirley St', 'Ruston', 'WA', '98407', 'Office', '530530603003', 'LN-14902738-1', 'https://www.loopnet.com/Listing/5219-N-Shirley-St-Ruston-WA/14902738/', None, 1200, None, None, None, None, '2021-04-23', False, 'Lease', None, 10375, 124500, 8300, '1st Floor', 'Not Listed', '30 Days', 'Negotiable'), ('5122 Olympic Dr NW', 'Gig Harbor', 'WA', '98335', 'Office', '530530724073', 'LN-14769505-1', 'https://www.loopnet.com/Listing/5122-Olympic-Dr-NW-Gig-Harbor-WA/14769505/', None, 750, None, None, None, None, '2021-04-23', False, 'Lease', None, 2769, 33222, 1582, '1st Fl, Ste A-103', 'Shell Space', 'Now', 'Negotiable'), ('5122 Olympic Dr NW', 'Gig Harbor', 'WA', '98335', 'Office', '530530724073', 'LN-14769505-2', 'https://www.loopnet.com/Listing/5122-Olympic-Dr-NW-Gig-Harbor-WA/14769505/', None, 2354, None, None, None, None, '2021-04-23', False, 'Lease', None, 4120, 49434, None, '2nd Fl, Ste A-203', 'Shell Space', 'Now', 'Negotiable'), ('4301 S Pine St', 'Tacoma', 'WA', '98409', 'Office', '530530626002', 'LN-13279587-1', 'https://www.loopnet.com/Listing/4301-S-Pine-St-Tacoma-WA/13279587/', None, 162, None, None, None, None, '2021-04-23', False, 'Lease', None, 324, 3888, None, 'Ground', 'Not Listed', 'Now', 'Negotiable'), ('4301 S Pine St', 'Tacoma', 'WA', '98409', 'Office', '530530626002', 'LN-13279587-2', 'https://www.loopnet.com/Listing/4301-S-Pine-St-Tacoma-WA/13279587/', None, 867, None, None, None, None, '2021-04-23', False, 'Lease', None, 1734, 20808, None, 'Ground, Ste 14', 'Not Listed', 'Now', 'Negotiable'), ('4301 S Pine St', 'Tacoma', 'WA', '98409', 'Office', '530530626002', 'LN-13279587-3', 'https://www.loopnet.com/Listing/4301-S-Pine-St-Tacoma-WA/13279587/', None, 2600, None, None, None, None, '2021-04-23', False, 'Lease', None, 5200, 62400, None, 'Ground, Ste 21', 'Not Listed', 'Now', 'Negotiable'), ('4301 S Pine St', 'Tacoma', 'WA', '98409', 'Office', '530530626002', 'LN-13279587-4', 'https://www.loopnet.com/Listing/4301-S-Pine-St-Tacoma-WA/13279587/', None, 1131, None, None, None, None, '2021-04-23', False, 'Lease', None, 2262, 27144, None, 'Ground, Ste 32', 'Not Listed', 'Now', 'Negotiable'), ('4301 S Pine St', 'Tacoma', 'WA', '98409', 'Office', '530530626002', 'LN-13279587-5', 'https://www.loopnet.com/Listing/4301-S-Pine-St-Tacoma-WA/13279587/', None, 1528, None, None, None, None, '2021-04-23', False, 'Lease', None, 3056, 36672, None, '4th Fl, Ste 451', 'Not Listed', 'Now', 'Negotiable'), ('4301 S Pine St', 'Tacoma', 'WA', '98409', 'Office', '530530626002', 'LN-13279587-6', 'https://www.loopnet.com/Listing/4301-S-Pine-St-Tacoma-WA/13279587/', None, 1204, None, None, None, None, '2021-04-23', False, 'Lease', None, 2408, 28896, None, '4th Fl, Ste 456', 'Not Listed', 'Now', 'Negotiable'), ('4301 S Pine St', 'Tacoma', 'WA', '98409', 'Office', '530530626002', 'LN-13279587-7', 'https://www.loopnet.com/Listing/4301-S-Pine-St-Tacoma-WA/13279587/', None, 616, None, None, None, None, '2021-04-23', False, 'Lease', None, 1232, 14784, None, '4th Fl, Ste 463', 'Not Listed', 'Now', 'Negotiable'), ('4301 S Pine St', 'Tacoma', 'WA', '98409', 'Office', '530530626002', 'LN-13279587-8', 'https://www.loopnet.com/Listing/4301-S-Pine-St-Tacoma-WA/13279587/', None, 1070, None, None, None, None, '2021-04-23', False, 'Lease', None, 2140, 25680, None, '5th Fl, Ste 501', 'Not Listed', 'Now', 'Negotiable'), ('3650 S Cedar St', 'Tacoma', 'WA', '98409', 'Office', '530530626002', 'LN-12936163-1', 'https://www.loopnet.com/Listing/3650-S-Cedar-St-Tacoma-WA/12936163/', None, 9600, None, None, None, None, '2021-04-23', False, 'Lease', None, 14400, 172800, None, '1st Fl, Ste 3650', 'Partial Build-Out', 'Now', 'Negotiable'), ('5804 384th St E', 'Eatonville', 'WA', '98328', 'Industrial', '530530730063', 'LN-12170476-1', 'https://www.loopnet.com/Listing/5804-384th-St-E-Eatonville-WA/12170476/', None, 26552, None, None, None, None, '2021-04-23', False, 'Lease', None, 5045, 60539, None, '1st Floor', 'Not Listed', 'Now', 'Negotiable'), ('502 S M St', 'Tacoma', 'WA', '98405', 'Medical', '530530613001', 'LN-9021108-1', 'https://www.loopnet.com/Listing/502-S-M-St-Tacoma-WA/9021108/', None, 7500, None, None, None, None, '2021-04-23', False, 'Lease', None, 13750, 165000, None, '2nd Floor', 'Not Listed', '30 Days', 'Negotiable'), ('502 S M St', 'Tacoma', 'WA', '98405', 'Medical', '530530613001', 'LN-9021108-2', 'https://www.loopnet.com/Listing/502-S-M-St-Tacoma-WA/9021108/', None, 3500, None, None, None, None, '2021-04-23', False, 'Lease', None, 6417, 77000, None, '3rd Floor', 'Not Listed', '30 Days', 'Negotiable'), ('1142 Broadway', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-8423207-1', 'https://www.loopnet.com/Listing/1142-Broadway-Tacoma-WA/8423207/', None, 2883, None, None, None, None, '2021-04-23', False, 'Lease', None, 3844, 46128, None, '2nd Fl, Ste 220', 'Not Listed', 'Now', 'Negotiable'), ('1142 Broadway', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-8423207-2', 'https://www.loopnet.com/Listing/1142-Broadway-Tacoma-WA/8423207/', None, 4853, None, None, None, None, '2021-04-23', False, 'Lease', None, 8986, 107834, None, '3rd Fl, Ste 300', 'Not Listed', '30 Days', 'Negotiable'), ('1142 Broadway', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-8423207-3', 'https://www.loopnet.com/Listing/1142-Broadway-Tacoma-WA/8423207/', None, 2555, None, None, None, None, '2021-04-23', False, 'Lease', None, 4684, 56210, None, '3rd Fl, Ste 310', 'Full Build-Out', 'Now', 'Negotiable'), ('1430 Wilmington Dr', 'Dupont', 'WA', '98327', 'Office/Retail', '530530728021', 'LN-7958994-1', 'https://www.loopnet.com/Listing/1430-Wilmington-Dr-Dupont-WA/7958994/', None, 1667, None, None, None, None, '2021-04-23', False, 'Lease', None, 2778, 33340, None, '1st Fl, Ste D1-120', 'Not Listed', '30 Days', 'Negotiable'), ('1430 Wilmington Dr', 'Dupont', 'WA', '98327', 'Office/Retail', '530530728021', 'LN-7958994-2', 'https://www.loopnet.com/Listing/1430-Wilmington-Dr-Dupont-WA/7958994/', None, 1250, None, None, None, None, '2021-04-23', False, 'Lease', None, 2083, 25000, None, '1st Fl, Ste D1-150', 'Not Listed', 'Now', 'Negotiable'), ('1120 Pacific Ave', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-4926653-1', 'https://www.loopnet.com/Listing/1120-Pacific-Ave-Tacoma-WA/4926653/', None, 7457, None, None, None, None, '2021-04-23', False, 'Lease', None, 7457, 89484, None, '3rd Fl, Ste 300', 'Partial Build-Out', '30 Days', 'Negotiable'), ('18209 State Highway 410 E', 'Bonney Lake', 'WA', '98391', 'Office', None, 'LN-4510665-1', 'https://www.loopnet.com/Listing/18209-State-Highway-410-E-Bonney-Lake-WA/4510665/', None, 5000, None, None, None, None, '2021-04-23', False, 'Lease', None, 43312, 519744, 21656, '1st Fl, Ste 100', 'Not Listed', '30 Days', '1-10 Yrs'), ('18209 State Highway 410 E', 'Bonney Lake', 'WA', '98391', 'Medical', None, 'LN-4510665-2', 'https://www.loopnet.com/Listing/18209-State-Highway-410-E-Bonney-Lake-WA/4510665/', None, 5000, None, None, None, None, '2021-04-23', False, 'Lease', None, 10000, 120000, None, '2nd Fl, Ste 100A', 'Not Listed', 'Now', 'Negotiable'), ('18209 State Highway 410 E', 'Bonney Lake', 'WA', '98391', 'Office', None, 'LN-4510665-3', 'https://www.loopnet.com/Listing/18209-State-Highway-410-E-Bonney-Lake-WA/4510665/', None, 2020, None, None, None, None, '2021-04-23', False, 'Lease', None, 4040, 48480, None, '3rd Fl, Ste 306', 'Shell Space', 'Now', '3-5 Yrs'), ('2115 S 56th St', 'Tacoma', 'WA', '98409', 'Office', '530530630001', 'LN-4146104-1', 'https://www.loopnet.com/Listing/2115-S-56th-St-Tacoma-WA/4146104/', None, 1200, None, None, None, None, '2021-04-23', False, 'Lease', None, 1600, 19200, None, '1st Fl, Ste 401', 'Not Listed', '30 Days', 'Negotiable'), ('2202 S Cedar St', 'Tacoma', 'WA', '98405', 'Medical', '530530611004', 'LN-4101115-1', 'https://www.loopnet.com/Listing/2202-S-Cedar-St-Tacoma-WA/4101115/', None, 3895, None, None, None, None, '2021-04-23', False, 'Lease', None, 10387, 124640, None, '2nd Fl, Ste 225', 'Not Listed', 'Now', 'Negotiable'), ('1145 Broadway', 'Tacoma', 'WA', '98402', 'Office/Retail', '530530616011', 'LN-4099813-1', 'https://www.loopnet.com/Listing/1145-Broadway-Tacoma-WA/4099813/', None, 7338, None, None, None, None, '2021-04-23', False, 'Lease', None, 17122, 205464, None, '1st Fl, Ste 100', 'Not Listed', 'Now', 'Negotiable'), ('1145 Broadway', 'Tacoma', 'WA', '98402', 'Office/Retail', '530530616011', 'LN-4099813-2', 'https://www.loopnet.com/Listing/1145-Broadway-Tacoma-WA/4099813/', None, 2477, None, None, None, None, '2021-04-23', False, 'Lease', None, 5780, 69356, None, '1st Fl, Ste 104', 'Not Listed', 'Now', 'Negotiable'), ('1145 Broadway', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-4099813-3', 'https://www.loopnet.com/Listing/1145-Broadway-Tacoma-WA/4099813/', None, 12000, None, None, None, None, '2021-04-23', False, 'Lease', None, 28000, 336000, None, '2nd Fl, Ste 200P', 'Not Listed', '30 Days', 'Negotiable'), ('1145 Broadway', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-4099813-4', 'https://www.loopnet.com/Listing/1145-Broadway-Tacoma-WA/4099813/', None, 6916, None, None, None, None, '2021-04-23', False, 'Lease', None, 16137, 193648, None, '6th Fl, Ste 600', 'Not Listed', 'Now', 'Negotiable'), ('1145 Broadway', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-4099813-5', 'https://www.loopnet.com/Listing/1145-Broadway-Tacoma-WA/4099813/', None, 12000, None, None, None, None, '2021-04-23', False, 'Lease', None, 28000, 336000, None, '8th Fl, Ste 800', 'Not Listed', '30 Days', 'Negotiable'), ('1145 Broadway', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-4099813-6', 'https://www.loopnet.com/Listing/1145-Broadway-Tacoma-WA/4099813/', None, 12000, None, None, None, None, '2021-04-23', False, 'Lease', None, 28000, 336000, None, '9th Fl, Ste 900', 'Not Listed', 'Dec 2021', 'Negotiable'), ('1145 Broadway', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-4099813-7', 'https://www.loopnet.com/Listing/1145-Broadway-Tacoma-WA/4099813/', None, 2029, None, None, None, None, '2021-04-23', False, 'Lease', None, 4734, 56812, None, '10th Fl, Ste 1070', 'Not Listed', '30 Days', 'Negotiable'), ('1145 Broadway', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-4099813-8', 'https://www.loopnet.com/Listing/1145-Broadway-Tacoma-WA/4099813/', None, 3631, None, None, None, None, '2021-04-23', False, 'Lease', None, 8472, 101668, None, '13th Fl, Ste 1330', 'Not Listed', '30 Days', 'Negotiable'), ('1145 Broadway', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-4099813-9', 'https://www.loopnet.com/Listing/1145-Broadway-Tacoma-WA/4099813/', None, 1400, None, None, None, None, '2021-04-23', False, 'Lease', None, 3267, 39200, None, '14th Fl, Ste 1450', 'Not Listed', '30 Days', 'Negotiable'), ('1102 Broadway', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-4099808-1', 'https://www.loopnet.com/Listing/1102-Broadway-Tacoma-WA/4099808/', None, 7305, None, None, None, None, '2021-04-23', False, 'Lease', None, 15219, 182625, None, '4th Fl, Ste 401', 'Full Build-Out', 'Now', 'Negotiable'), ('1102 Broadway', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-4099808-2', 'https://www.loopnet.com/Listing/1102-Broadway-Tacoma-WA/4099808/', None, 4072, None, None, None, None, '2021-04-23', False, 'Lease', None, 8483, 101800, None, '5th Fl, Ste 501', 'Not Listed', 'Now', 'Negotiable'), ('2121 S State St', 'Tacoma', 'WA', '98405', 'Office', '530530617003', 'LN-4051415-1', 'https://www.loopnet.com/Listing/2121-S-State-St-Tacoma-WA/4051415/', None, 5000, None, None, None, None, '2021-04-23', False, 'Lease', None, 18133, 217598, 9671, '1st Floor', 'Partial Build-Out', 'Now', 'Negotiable'), ('4700 Point Fosdick Dr', 'Gig Harbor', 'WA', '98335', 'Office/Medical', '530530724082', 'LN-4038399-1', 'https://www.loopnet.com/Listing/4700-Point-Fosdick-Dr-Gig-Harbor-WA/4038399/', None, 2300, None, None, None, None, '2021-04-23', False, 'Lease', None, 5750, 69000, None, '1st Fl, Ste 108', 'Shell Space', 'Now', '2-10 Yrs'), ('4700 Point Fosdick Dr', 'Gig Harbor', 'WA', '98335', 'Office/Medical', '530530724082', 'LN-4038399-2', 'https://www.loopnet.com/Listing/4700-Point-Fosdick-Dr-Gig-Harbor-WA/4038399/', None, 2287, None, None, None, None, '2021-04-23', False, 'Lease', None, 5718, 68610, None, '2nd Fl, Ste 216', 'Raw Space', 'Now', '2-10 Yrs'), ('4700 Point Fosdick Dr', 'Gig Harbor', 'WA', '98335', 'Office', '530530724082', 'LN-4038399-3', 'https://www.loopnet.com/Listing/4700-Point-Fosdick-Dr-Gig-Harbor-WA/4038399/', None, 4965, None, None, None, None, '2021-04-23', False, 'Lease', None, 12413, 148950, None, '3rd Fl, Ste 301', 'Full Build-Out', 'Now', '2-10 Yrs'), ('4700 Point Fosdick Dr', 'Gig Harbor', 'WA', '98335', 'Office', '530530724082', 'LN-4038399-4', 'https://www.loopnet.com/Listing/4700-Point-Fosdick-Dr-Gig-Harbor-WA/4038399/', None, 1434, None, None, None, None, '2021-04-23', False, 'Lease', None, 3585, 43020, None, '3rd Fl, Ste 305', 'Full Build-Out', '30 Days', '2-10 Yrs'), ('4700 Point Fosdick Dr', 'Gig Harbor', 'WA', '98335', 'Office', '530530724082', 'LN-4038399-5', 'https://www.loopnet.com/Listing/4700-Point-Fosdick-Dr-Gig-Harbor-WA/4038399/', None, 4400, None, None, None, None, '2021-04-23', False, 'Lease', None, 11000, 132000, None, '3rd Fl, Ste 315', 'Raw Space', 'Now', 'Negotiable'), ('15 S Oregon Ave', 'Tacoma', 'WA', '98409', 'Office', '530530626002', 'LN-3949712-1', 'https://www.loopnet.com/Listing/15-S-Oregon-Ave-Tacoma-WA/3949712/', None, 744, None, None, None, None, '2021-04-23', False, 'Lease', None, 620, 7440, None, '1st Fl, Ste 102', 'Not Listed', '30 Days', 'Negotiable'), ('15 S Oregon Ave', 'Tacoma', 'WA', '98409', 'Office', '530530626002', 'LN-3949712-2', 'https://www.loopnet.com/Listing/15-S-Oregon-Ave-Tacoma-WA/3949712/', None, 2210, None, None, None, None, '2021-04-23', False, 'Lease', None, 1842, 22100, None, '1st Fl, Ste 111', 'Not Listed', 'Now', 'Negotiable'), ('15 S Oregon Ave', 'Tacoma', 'WA', '98409', 'Office', '530530626002', 'LN-3949712-3', 'https://www.loopnet.com/Listing/15-S-Oregon-Ave-Tacoma-WA/3949712/', None, 854, None, None, None, None, '2021-04-23', False, 'Lease', None, 711, 8540, None, '2nd Fl, Ste 203', 'Not Listed', '30 Days', 'Negotiable'), ('15102 Woodbrook Dr SW', 'Lakewood', 'WA', '98439', 'Industrial', '530530720002', 'LN-22509638-1', 'https://www.loopnet.com/Listing/15102-Woodbrook-Dr-SW-Lakewood-WA/22509638/', None, 148407, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, None, '1st Fl, Ste 100', 'Shell Space', 'Jan 2022', 'Negotiable'), ('19000 38th Ave', 'Spanaway', 'WA', '98387', 'Industrial', None, 'LN-22481521-1', 'https://www.loopnet.com/Listing/19000-38th-Ave-Spanaway-WA/22481521/', None, 645151, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, None, '1st Floor', 'Shell Space', 'Apr 2022', 'Negotiable'), ('19000 38th Ave', 'Spanaway', 'WA', '98387', 'Industrial', None, 'LN-21909466-1', 'https://www.loopnet.com/Listing/19000-38th-Ave-Spanaway-WA/21909466/', None, 862167, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, None, '1st Floor', 'Shell Space', '30 Days', 'Negotiable'), ('19000 38th Ave', 'Spanaway', 'WA', '98387', 'Industrial', None, 'LN-21909466-2', 'https://www.loopnet.com/Listing/19000-38th-Ave-Spanaway-WA/21909466/', None, 312000, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, None, '1st Floor', 'Full Build-Out', '30 Days', 'Negotiable'), ('10002 Steele St', 'Tacoma', 'WA', '98444', 'Industrial', None, 'LN-21490354-1', 'https://www.loopnet.com/Listing/10002-Steele-St-Tacoma-WA/21490354/', None, 128634, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, None, '1st Floor', 'Raw Space', 'Jan 2022', 'Negotiable'), ('28002 State Route 410', 'Buckley', 'WA', '98321', 'Industrial', '530530702072', 'LN-21179466-1', 'https://www.loopnet.com/Listing/28002-State-Route-410-Buckley-WA/21179466/', None, 1200, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, 10000, '1st Floor', 'Shell Space', 'Jun 2021', 'Negotiable'), ('14720 Woodbrook Dr SW', 'Lakewood', 'WA', '98439', 'Industrial', '530530720001', 'LN-20066097-1', 'https://www.loopnet.com/Listing/14720-Woodbrook-Dr-SW-Lakewood-WA/20066097/', None, 158579, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, None, '1st Fl, Ste 1', 'Shell Space', 'May 2021', 'Negotiable'), ('917 Valley Ave NW', 'Puyallup', 'WA', '98371', 'Industrial', '530539400101', 'LN-19775695-1', 'https://www.loopnet.com/Listing/917-Valley-Ave-NW-Puyallup-WA/19775695/', None, 19606, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, None, '1st Floor', 'Full Build-Out', 'Now', 'Negotiable'), ('2205-2207 70th Ave W', 'Tacoma', 'WA', '98466', 'Flex', '530530723111', 'LN-19320593-1', 'https://www.loopnet.com/Listing/2205-2207-70th-Ave-W-Tacoma-WA/19320593/', None, 300, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, 2000, '1st Floor', 'Not Listed', 'Now', 'Negotiable'), ('11105 Steele St S', 'Tacoma', 'WA', '98444', 'Flex', None, 'LN-19159666-1', 'https://www.loopnet.com/Listing/11105-Steele-St-S-Tacoma-WA/19159666/', None, 400, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, 2000, '1st Floor', 'Not Listed', '30 Days', 'Negotiable'), ('4663 196th St E', 'Spanaway', 'WA', '98387', 'Industrial', None, 'LN-18403459-1', 'https://www.loopnet.com/Listing/4663-196th-St-E-Spanaway-WA/18403459/', None, 352801, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, None, '1st Floor', 'Not Listed', '30 Days', 'Negotiable'), ('4417 192nd St E', 'Tacoma', 'WA', '98446', 'Industrial', '530530714132', 'LN-18403357-1', 'https://www.loopnet.com/Listing/4417-192nd-St-E-Tacoma-WA/18403357/', None, 281181, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, None, '1st Floor', 'Full Build-Out', 'Now', 'Negotiable'), ('11511 Canterwood Blvd NW', 'Gig Harbor', 'WA', '98332', 'Office/Medical', '530530725092', 'LN-17534058-1', 'https://www.loopnet.com/Listing/11511-Canterwood-Blvd-NW-Gig-Harbor-WA/17534058/', None, 2123, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, None, '1st Fl, Ste 120', 'Not Listed', 'Now', 'Negotiable'), ('11511 Canterwood Blvd NW', 'Gig Harbor', 'WA', '98332', 'Office/Medical', '530530725092', 'LN-17534058-2', 'https://www.loopnet.com/Listing/11511-Canterwood-Blvd-NW-Gig-Harbor-WA/17534058/', None, 4002, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, None, '2nd Fl, Ste 250', 'Shell Space', 'Now', '8-10 Yrs'), ('3451 84th St S', 'Lakewood', 'WA', '98499', 'Industrial', '530530718081', 'LN-16387442-1', 'https://www.loopnet.com/Listing/3451-84th-St-S-Lakewood-WA/16387442/', None, 61496, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, 245987, '1st Floor', 'Raw Space', '30 Days', 'Negotiable'), ('12012 47th Ave SW', 'Lakewood', 'WA', '98499', 'Industrial', '530530718061', 'LN-14058023-1', 'https://www.loopnet.com/Listing/12012-47th-Ave-SW-Lakewood-WA/14058023/', None, 284800, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, None, '1st Floor', 'Not Listed', 'TBD', 'Negotiable'), ('12012 47th Ave SW', 'Lakewood', 'WA', '98499', 'Industrial', '530530718061', 'LN-14058022-1', 'https://www.loopnet.com/Listing/12012-47th-Ave-SW-Lakewood-WA/14058022/', None, 216200, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, None, '1st Floor', 'Full Build-Out', 'TBD', 'Negotiable'), ('11515 Burnham Dr', 'Gig Harbor', 'WA', '98332', 'Office', '530530725041', 'LN-13760017-1', 'https://www.loopnet.com/Listing/11515-Burnham-Dr-Gig-Harbor-WA/13760017/', None, 100, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, None, '1st Fl, Ste 104E', 'Not Listed', 'Now', 'Negotiable'), ('1710 136th Ave E', 'Sumner', 'WA', '98390', 'Industrial', '530530733013', 'LN-13503737-1', 'https://www.loopnet.com/Listing/1710-136th-Ave-E-Sumner-WA/13503737/', None, 32718, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, None, '1st Floor', 'Raw Space', '30 Days', 'Negotiable'), ('1201 Pacific Ave', 'Tacoma', 'WA', '98402', 'Office', '530530616011', 'LN-4426028-1', 'https://www.loopnet.com/Listing/1201-Pacific-Ave-Tacoma-WA/4426028/', None, 100, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, 5000, '6th Fl, Ste 600', 'Full Build-Out', 'TBD', 'Negotiable'), ('1323 34th Ave E', 'Tacoma', 'WA', '98424', 'Office', '530539400022', 'LN-22227833-1', 'https://www.loopnet.com/Listing/1323-34th-Ave-E-Tacoma-WA/22227833/', None, 68151, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, None, '1st Floor', 'Not Listed', 'Now', 'Negotiable'), ('448 E 18th St', 'Tacoma', 'WA', '98421', 'Industrial', '530530602001', 'LN-22076986-1', 'https://www.loopnet.com/Listing/448-E-18th-St-Tacoma-WA/22076986/', None, 36000, None, None, None, None, '2021-04-23', False, 'Lease', None, 27360, 328320, None, '1st Floor', 'Not Listed', '30 Days', 'Negotiable'), ('3003 S Pine St', 'Tacoma', 'WA', '98409', 'Industrial', '530530626002', 'LN-22019209-1', 'https://www.loopnet.com/Listing/3003-S-Pine-St-Tacoma-WA/22019209/', None, 49434, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, None, '1st Floor', 'Partial Build-Out', 'May 2021', 'Negotiable'), ('8815 S Tacoma Way', 'Lakewood', 'WA', '98499', 'Retail', '530530718083', 'LN-21047924-1', 'https://www.loopnet.com/Listing/8815-S-Tacoma-Way-Lakewood-WA/21047924/', None, 2000, None, None, None, None, '2021-04-23', False, 'Lease', None, 3000, 36000, None, '1st Fl, Ste 101', 'Full Build-Out', 'Now', 'Negotiable'), ('8815 S Tacoma Way', 'Lakewood', 'WA', '98499', 'Office', '530530718083', 'LN-21047924-2', 'https://www.loopnet.com/Listing/8815-S-Tacoma-Way-Lakewood-WA/21047924/', None, 1655, None, None, None, None, '2021-04-23', False, 'Lease', None, 2483, 29790, None, '1st Fl, Ste 102', 'Not Listed', 'Now', 'Negotiable'), ('8815 S Tacoma Way', 'Lakewood', 'WA', '98499', 'Office', '530530718083', 'LN-21047924-3', 'https://www.loopnet.com/Listing/8815-S-Tacoma-Way-Lakewood-WA/21047924/', None, 550, None, None, None, None, '2021-04-23', False, 'Lease', None, 825, 9900, None, '1st Fl, Ste 103', 'Not Listed', 'Now', 'Negotiable'), ('8815 S Tacoma Way', 'Lakewood', 'WA', '98499', 'Office', '530530718083', 'LN-21047924-4', 'https://www.loopnet.com/Listing/8815-S-Tacoma-Way-Lakewood-WA/21047924/', None, 5510, None, None, None, None, '2021-04-23', False, 'Lease', None, 8265, 99180, None, '1st Fl, Ste 104', 'Not Listed', 'Now', 'Negotiable'), ('3304 56th St', 'Gig Harbor', 'WA', '98335', 'Office/Retail', '530530724082', 'LN-18278584-1', 'https://www.loopnet.com/Listing/3304-56th-St-Gig-Harbor-WA/18278584/', None, 2000, None, None, None, None, '2021-04-23', False, 'Lease', None, 13856, 166275, 6651, 'Basement, Ste 100', 'Shell Space', 'Now', 'Negotiable'), ('3304 56th St', 'Gig Harbor', 'WA', '98335', 'Office/Retail', '530530724082', 'LN-18278584-2', 'https://www.loopnet.com/Listing/3304-56th-St-Gig-Harbor-WA/18278584/', None, 1500, None, None, None, None, '2021-04-23', False, 'Lease', None, 13781, 165375, 6615, '1st Fl, Ste 200', 'Shell Space', 'Now', 'Negotiable'), ('3304 56th St', 'Gig Harbor', 'WA', '98335', 'Office/Retail', '530530724082', 'LN-18278584-3', 'https://www.loopnet.com/Listing/3304-56th-St-Gig-Harbor-WA/18278584/', None, 2500, None, None, None, None, '2021-04-23', False, 'Lease', None, 11667, 140000, 5600, '2nd Fl, Ste 300', 'Shell Space', 'Now', 'Negotiable'), ('2400 70th Ave E', 'Fife', 'WA', '98424', 'Industrial', '530539400123', 'LN-17979432-1', 'https://www.loopnet.com/Listing/2400-70th-Ave-E-Fife-WA/17979432/', None, 29860, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, None, '1st Fl, Ste B120', 'Not Listed', 'Now', 'Negotiable'), ('1510 Puyallup St', 'Sumner', 'WA', '98390', 'Industrial', '530530733014', 'LN-17287950-1', 'https://www.loopnet.com/Listing/1510-Puyallup-St-Sumner-WA/17287950/', None, 90000, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, 190042, '1st Floor', 'Not Listed', 'Now', 'Negotiable'), ('3003 W Valley Hwy E', 'Sumner', 'WA', '98390', 'Industrial', '530530733013', 'LN-15451887-1', 'https://www.loopnet.com/Listing/3003-W-Valley-Hwy-E-Sumner-WA/15451887/', None, 123209, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, None, '1st Floor', 'Not Listed', '90 Days', 'Negotiable'), ('2801 Hollycroft St', 'Gig Harbor', 'WA', '98335', 'Office', '530530724071', 'LN-13870546-1', 'https://www.loopnet.com/Listing/2801-Hollycroft-St-Gig-Harbor-WA/13870546/', None, 4188, None, None, None, None, '2021-04-23', False, 'Lease', None, None, None, None, '1st Fl, Ste B9', 'Not Listed', '30 Days', '1-5 Yrs'), ('11016 Bridgeport Way SW', 'Lakewood', 'WA', '98499', 'Office/Retail', '530530719012', 'LN-13827279-1', 'https://www.loopnet.com/Listing/11016-Bridgeport-Way-SW-Lakewood-WA/13827279/', None, 2600, None, None, None, None, '2021-04-23', False, 'Lease', None, 3033, 36400, None, '1st Floor', 'Not Listed', 'Now', 'Negotiable')]

        lease_insert = 'INSERT INTO "ETL_Building" VALUES ' \
                           '(%s, %s, %s, %s, %s, %s,' \
                           ' %s, %s, cast(%s as double precision), cast(%s as double precision), %s, %s,' \
                           ' %s, %s, %s, %s, %s, %s, cast(%s as double precision),' \
                           ' cast(%s as double precision), cast(%s as double precision), %s, %s, %s, %s)'
        for i in lease_listings:  # In same order as reference above.
            if i[6] not in csid_list:
                cur.execute(lease_insert, i)
                print(i)
            elif i[6] in csid_list:
                print('Record already in database')
                pass
        conn.commit()

    except (Exception, psycopg2.DatabaseError) as error:
        print(error) #TODO Change this to error logging? (or find what the correct terminology is.)
    finally:
        if conn is not None:
            conn.close()
            print('Database connection closed.')

def sale_insert():  # Found def config and def connect from https://www.postgresqltutorial.com/postgresql-python/connect/
    """ Connect to the PostgreSQL database server """
    conn = None
    url_list = sale.grab_placards()
    property_info = sale.listing_info(url_list)
    sale_listings = sale.sale_export(property_info)
    try:
        params = config()  # read connection parameters
        print('Connecting to the PostgreSQL database...')  # connect to the PostgreSQL server
        conn = psycopg2.connect(**params)
        ##
        etl_csid = 'SELECT "CS_ID" FROM "ETL_Building";'
        cur.execute(etl_csid)  # execute a statement
        etl_csid_list = cur.fetchall()  # Fetch the results of the statement (Notice fetchone ONLY grabs the first record of the result)
        csid_list = [t[0] for t in etl_csid_list]
        print("We are starting with {} records in the ETL Table.".format(len(etl_csid_list)))
        cur.close()
        cur = conn.cursor()
        sale_insert = 'INSERT INTO "ETL_Building" VALUES ' \
                           '(%s, %s, %s, %s, %s, %s,' \
                           ' %s, %s, cast(%s as double precision), cast(%s as double precision), %s, %s,' \
                           ' %s, %s, %s, %s, %s, %s, cast(%s as double precision),' \
                           ' cast(%s as double precision), cast(%s as double precision), %s, %s, %s, %s)'
        for i in sale_listings:  # In same order as reference above.
            if i[6] not in csid_list:
                cur.execute(sale_insert, i)
                print(i)
            elif i[6] in csid_list:
                print('Record already in database')
                pass
        conn.commit()
    except (Exception, psycopg2.DatabaseError) as error:
        print(error) #TODO Change this to error logging? (or find what the correct terminology is.)
    finally:
        if conn is not None:
            conn.close()
            print('Database connection closed.')

def etl_to_primary():
    """ Connect to the PostgreSQL database server """
    conn = None
    try:
        params = config()# read connection parameters
        print('Connecting to the PostgreSQL database...')# connect to the PostgreSQL server
        conn = psycopg2.connect(**params)
        # Statement to check ETL_Building against Building.
        cur = conn.cursor()
        left_exclude_join = 'SELECT "ETL_Building".* FROM "ETL_Building" Left JOIN "Building" ON "ETL_Building"."CS_ID" = "Building"."CS_ID" WHERE "Building"."CS_ID" IS NULL'
        cur.execute(left_exclude_join)
        left_exclude_join_result = cur.fetchall()
        print("There are {} records to be updated from ETL_Building.".format(len(left_exclude_join_result)))
        for i in left_exclude_join_result:
            data = (i[0], i[1], i[2], i[3], i[4], i[5], i[6], i[7], i[8], i[9], i[10], i[11], i[12],
                    i[13], i[14], i[15], i[16], i[17], i[18], i[19], i[20], i[21], i[22], i[23], i[24])
            print("Inserting {} into the Building table".format(i[6]))
            insert_command = 'INSERT INTO "Building" VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)'  # insert statement to Building Table
            cur.execute(insert_command, data)  # Pass in two arguments to make life easier.
        conn.commit()  # ensure that changes are updated to the database
        cur.close()
    except (Exception, psycopg2.DatabaseError) as error:
        print(error)  # TODO Change this to error logging? (or find what the correct terminology is.)
    finally:
        if conn is not None:
            conn.close()
            print('Database connection closed.')


def find_current_listings():
    """ Connect to the PostgreSQL database server """
    conn = None
    try:
        params = config()  # read connection parameters
        conn = psycopg2.connect(**params)
        cur = conn.cursor()
        querry = 'SELECT "CS_ID", url FROM "Building" WHERE "Currently_listed" = true;'
        cur.execute(querry)
        result = cur.fetchall()
        conn.close()
        # Reinitialize db connection after getting off_market_list to ensure connection.
        off_market_csid = sale.update_sale_listings(result)
        params = config()  # read connection parameters
        conn = psycopg2.connect(**params)
        cur = conn.cursor()
        for i in off_market_csid:
            delist_command = 'UPDATE "Building" SET "Currently_listed" = false WHERE "CS_ID" = \'{}\''.format(i)
            print("Updating {} currently_listed to 'false'. ".format(i))
            cur.execute(delist_command)
        conn.commit()
    except (Exception, psycopg2.DatabaseError) as error:
        print(error)  # TODO Change this to error logging? (or find what the correct terminology is.)
    finally:
        if conn is not None:
            conn.close()
            print('Database connection closed.')



if __name__ == '__main__':
    sale_insert()
    lease_insert()
    etl_to_primary()
    #find_current_listings()